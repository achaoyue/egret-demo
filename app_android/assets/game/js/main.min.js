var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{c(r.next(t))}catch(e){o(e)}}function s(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}c((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(r){n=[6,r],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},BaseScene=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.initView,e),e}return __extends(e,t),e.prototype.initView=function(){},e}(egret.DisplayObjectContainer);__reflect(BaseScene.prototype,"BaseScene");var Movejiaohu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initView=function(){var t=this;this.infoText=new egret.TextField,this.infoText.y=10,this.infoText.x=10,this.infoText.text="点到我了吗",this.addChild(this.infoText);var e=Utils.createBitmapByName("cartoon_png");this.addChild(e),e.x=(Utils.getStageWidth()-e.width)/2,e.y=(Utils.getStageHeight()-e.height)/2,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(n){egret.Tween.removeTweens(e);var r=egret.Tween.get(e);r.to({x:n.localX,y:n.localY},300);var i=e.hitTestPoint(n.localX,n.localY,!0);t.infoText.text="点到我了吗: "+i},this)},e}(BaseScene);__reflect(Movejiaohu.prototype,"Movejiaohu");var Api=function(){function t(){}return t}();__reflect(Api.prototype,"Api");var Http=function(){function t(){return this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this}return t.prototype.post=function(e,n){var r=this;void 0===n&&(n={});var i=null,o=t.timeout;return new Promise(function(t,a){r.request.open(r.getUrl(e),egret.HttpMethod.POST),r.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.request.send(r.formatPostData(n)),r.request.addEventListener(egret.Event.COMPLETE,function(e){var n=e.currentTarget;egret.clearTimeout(i),t(JSON.parse(n.response))},r),r.request.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){egret.clearTimeout(i),a(t)},r),i=egret.setTimeout(function(){a({msg:"该链接已超时: "+o,url:e,param:n})},r,o)})},t.prototype.get=function(e,n){var r=this;void 0===n&&(n={});var i=null,o=t.timeout;return new Promise(function(t,a){var s=r.formatPostData(n),c=r.getUrl(e);""!==s&&(c+="?"+s),r.request.open(c,egret.HttpMethod.GET),r.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.request.send(),r.request.addEventListener(egret.Event.COMPLETE,function(e){var n=e.currentTarget;egret.clearTimeout(i),t(JSON.parse(n.response))},r),r.request.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){egret.clearTimeout(i),a(t)},r),i=egret.setTimeout(function(){a({msg:"该链接已超时: "+o,url:e,param:n})},r,o)})},t.prototype.getUrl=function(e){if("string"==typeof t.domain&&t.domain.length>0)return"http://"+t.domain;if("function"==typeof t.domain){var n=t.domain();return n&&""!==n?"http://"+n+e:e}return e},t.setDomain=function(e){"string"==typeof e||"function"==typeof e?t.domain=e:console.log("setDomain 的参数 domain 必须是一个字符串或者函数")},t.prototype.formatPostData=function(t){var e=[],n="";for(var r in t)if("object"==typeof t[r]){try{n=JSON.stringify(t[r])}catch(i){console.log("Http.formatPostData 参数异常: ",t),n=""}e.push(r+"="+n)}else e.push(r+"="+t[r]);return e.length<=0?void 0:e.join("&")},t.domain=null,t.timeout=3e4,t}();__reflect(Http.prototype,"Http");var Point=function(){function t(t,e){this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.equal=function(t){return t&&t.x===this.x&&t.y===this.y},t.prototype.copy=function(){return new t(this.x,this.y)},t}();__reflect(Point.prototype,"Point");var Utils=function(){function t(){}return t.getStageHeight=function(){return egret.MainContext.instance.stage.stageHeight},t.getStageWidth=function(){return egret.MainContext.instance.stage.stageWidth},t.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},t.createMovieClipByName=function(t){var e=RES.getRes(t+"_json");console.log(e);var n=RES.getRes(t+"_png"),r=new egret.MovieClipDataFactory(e,n);return new egret.MovieClip(r.generateMovieClipData(t))},t.bitmapToBtn=function(t,e){function n(){t.anchorOffsetX=i.x,t.anchorOffsetY=i.y,t.x=r.x,t.y=r.y,t.scaleX=1,t.scaleY=1}t.touchEnabled=!0;var r=new Point(t.x,t.y),i=new Point(t.anchorOffsetX,t.anchorOffsetY);t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,new Point(t.anchorOffsetX,t.anchorOffsetY).equal(i)||(t.x=r.x+t.anchorOffsetX,t.y=r.y+t.anchorOffsetY),t.scaleX=.95,t.scaleY=.95},this),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n(),e&&e()},this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,n,this),t.addEventListener(egret.TouchEvent.TOUCH_END,n,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,n,this)},t}();__reflect(Utils.prototype,"Utils");var Message=function(t){function e(){var e=t.call(this)||this;return e.bg=Utils.createBitmapByName("egret_icon_png"),e.bg.y=-10,e.addChild(e.bg),e.txtStr=new egret.TextField,e.txtStr.textColor=16662101,e.txtStr.width=Utils.getStageWidth(),e.txtStr.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtStr),e}return __extends(e,t),e.prototype.show=function(t){console.log(t),this.txtStr.text=t,this.bg.width=this.txtStr.textWidth+50,this.bg.height=this.txtStr.textHeight+20,this.bg.x=Utils.getStageWidth()-this.bg.width>>1,this.y=Utils.getStageHeight()>>1,this.alpha=1,egret.Tween.get(this).wait(1e3).to({y:this.y-100,alpha:0},1e3,egret.Ease.quadIn).call(this.tweenEnd,this)},e.prototype.tweenEnd=function(){this.parent&&(SceneController.instance.getState().removeChild(this),e.pool.push(this))},e.show=function(t){var n;n=e.pool.length>0?e.pool.pop():new e,n&&(n.show(t),SceneController.instance.getState().addChild(n))},e.pool=[],e}(egret.DisplayObjectContainer);__reflect(Message.prototype,"Message");var Air=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initView=function(){var t=new egret.TextField;t.width=282,t.height=43,t.x=10,t.y=10,t.textColor=0,t.text="afdsfdsf",this.addChild(t);var e=Utils.createBitmapByName("cartoon_png");e.blendMode=egret.BlendMode.ERASE,this.addChild(e),this.addEventListener(egret.Event.ENTER_FRAME,function(){var e=egret.getTimer();console.log(e),t.x=10},this)},e.prototype.fn=function(){console.log(1111)},e}(BaseScene);__reflect(Air.prototype,"Air");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return n.sent(),this.stage.removeChild(t),[3,4];case 3:return e=n.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){SceneController.instance.setStage(this.stage),SceneController.initGame()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var EndScene=function(){function t(){}return t}();__reflect(EndScene.prototype,"EndScene");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=Utils.getStageWidth(),this.textField.x=(Utils.getStageWidth()-this.textField.width)/2,this.textField.y=(Utils.getStageHeight()-this.textField.height)/2,this.textField.textAlign="center",this.textField.text="Loading...0%"},e.prototype.onProgress=function(t,e){var n=100*t/e;this.textField.text="Loading..."+n.toFixed(0)+"%"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var PlayScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initView=function(){var t=new Air;new Movejiaohu;this.addChild(t)},e}(BaseScene);__reflect(PlayScene.prototype,"PlayScene");var SceneController=function(){function t(){this.startScene=new StartScene,this.playScene=new PlayScene,this.endScene=new EndScene}return Object.defineProperty(t,"instance",{get:function(){return this.sceneController||(this.sceneController=new t),this.sceneController},enumerable:!0,configurable:!0}),t.prototype.setStage=function(t){this.stage=t},t.prototype.getState=function(){return this.stage},t.initGame=function(){var t=this.instance.stage;t.removeChildren(),t.addChild(this.instance.startScene)},t.showPlayScene=function(){var t=this.instance.stage;t.removeChildren(),t.addChild(this.instance.playScene)},t.showEndScene=function(){var t=this.instance.stage;t.removeChildren(),t.addChild(this.instance.playScene)},t.addScene=function(t){var e=this.instance.stage;e.addChild(t)},t.replaceScene=function(t){var e=this.instance.stage;e.removeChildren(),e.addChild(t)},t}();__reflect(SceneController.prototype,"SceneController");var StartScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initView=function(){var t=Utils.createBitmapByName("bg_jpg");this.addChild(t),t.x=(Utils.getStageWidth()-t.width)/2,t.y=(Utils.getStageHeight()-t.height)/2;var e=Utils.createBitmapByName("btn_start_png");this.addChild(e),e.x=(Utils.getStageWidth()-e.width)/2,e.y=Utils.getStageHeight()-350,Utils.bitmapToBtn(e,function(){SceneController.showPlayScene()})},e}(BaseScene);__reflect(StartScene.prototype,"StartScene");var GameData=function(){function t(){}return t.level=0,t.step=0,t.gridMargin=10,t}();__reflect(GameData.prototype,"GameData");